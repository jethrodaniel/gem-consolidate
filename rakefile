require "rake/clean"
require "bundler/gem_tasks"

task :default => %i[test install fib]

task :fib do
  sh "gem consolidate example/lib/fib.rb --footer='1.upto(10).each{|n|p Fib.fibonacci(n)}' > fib.rb"
  sh "ruby fib.rb"
end

require "rake/testtask"
desc 'Run the tests'
task :spec => :test
Rake::TestTask.new(:test) do |t|
  t.libs << "spec"
  t.libs << "lib"
  t.test_files = FileList["spec/**/*_spec.rb"]
  t.warning = false # suppress `circular require` from minitest
end

CLEAN << 'pkg'
